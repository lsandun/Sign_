flowchart TD
    A[ðŸ Start] --> B[ðŸ“„ Upload Signature Sheet]
    B --> C{ðŸ“‹ File Valid?}
    C -->|âŒ No| D[ðŸš« Return Error]
    C -->|âœ… Yes| E[ðŸ’¾ Save File]
    E --> F[ðŸ¤– Load YOLO Model]
    F --> G[ðŸ” Detect Objects]
    G --> H[ðŸ”¤ Extract Registration Codes]
    G --> I[âœï¸ Extract Signatures]
    
    H --> J[ðŸ“– OCR Processing]
    J --> K[âœ… Validate SEU Format]
    K --> L{ðŸŽ¯ Valid Code?}
    L -->|âŒ No| M[â­ï¸ Skip Signature]
    L -->|âœ… Yes| N[ðŸ“ Find Student Folder]
    
    I --> O[ðŸ”§ Preprocess Signature]
    N --> P{ðŸ‘¤ Student Exists?}
    P -->|âŒ No| Q[â“ Mark as Unknown]
    P -->|âœ… Yes| R[ðŸ“š Load Genuine Signatures]
    
    O --> S[ðŸ” Compare with References]
    R --> S
    S --> T[ðŸ“Š Calculate Similarity]
    T --> U{ðŸ“ˆ Similarity > Threshold?}
    U -->|âœ… Yes| V[âœ… Mark as Genuine]
    U -->|âŒ No| W[âŒ Mark as Fake]
    
    V --> X[ðŸ’¾ Store Result]
    W --> X
    M --> X
    Q --> X
    
    X --> Y{ðŸ”„ More Signatures?}
    Y -->|âœ… Yes| H
    Y -->|âŒ No| Z[ðŸ“Š Generate CSV]
    Z --> AA[ðŸ“‹ Display Results]
    AA --> BB[ðŸ End]
    
    D --> BB
    
    %% Styling
    classDef startEnd fill:#e1f5fe,stroke:#0277bd,stroke-width:3px
    classDef process fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef decision fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef error fill:#ffebee,stroke:#d32f2f,stroke-width:2px
    classDef success fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef storage fill:#f1f8e9,stroke:#689f38,stroke-width:2px
    
    class A,BB startEnd
    class B,E,F,G,H,I,J,K,N,O,R,S,T,Z,AA process
    class C,L,P,U,Y decision
    class D,M,Q,W error
    class V success
    class X storage